# amanita.breakcorn.ru

Видео-плеер с автоматической очисткой памяти для непрерывного воспроизведения YouTube и Vimeo контента.

## Проблема решена: Переполнение памяти

В версии 0.0.10+ исправлена проблема переполнения памяти при длительном просмотре YouTube видео.

### Реализованные решения:

1. **Периодическое пересоздание плеера** - каждые 5 видео плеер полностью уничтожается и создается заново
2. **Принудительная очистка iframe** - YouTube embed элементы корректно удаляются из DOM
3. **Мониторинг памяти** - автоматическое отслеживание потребления памяти каждые 30 секунд
4. **Чередование провайдеров** - приоритет отдается смене YouTube ↔ Vimeo для лучшей очистки ресурсов
5. **Принудительная сборка мусора** - для браузеров с поддержкой manual GC

### Отладка памяти:

- Откройте консоль разработчика (F12)
- Следите за сообщениями "Memory: XXmb / XXmb" - должны появляться каждые 30 секунд
- Сообщение "Recreating player for memory cleanup..." показывает пересоздание плеера

### Новое в 0.0.11+: Автоматическое самовосстановление:

- **Обнаружение ошибок** - автоматический переход к следующему видео при ошибках загрузки
- **Таймаут загрузки** - 15 секунд максимум на загрузку видео
- **Мануальный пропуск** - пробел, клавиша N или клик по экрану
- **Проверка здоровья** - каждую минуту проверяет, не застряло ли видео
- **Умное чередование** - смена провайдера только при множественных ошибках

### Управление:

- **Пробел** - следующее видео
- **Клавиша N** - следующее видео  
- **Клик по экрану** - следующее видео (но не на контролы)

### Настройки (в коде):

- `MAX_VIDEOS_BEFORE_RECREATE = 5` - частота пересоздания плеера
- `MAX_CONSECUTIVE_FAILURES = 3` - максимум ошибок подряд до пересоздания
- `VIDEO_LOAD_TIMEOUT = 15000` - таймаут загрузки в мс
- `PREFER_PROVIDER_ALTERNATION = false` - отключено, не мешает моноисточникам
