<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Œõ V X T V</title>
  <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
  <!-- Yandex.Metrika counter -->
  <script type="text/javascript" >
     (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
     m[i].l=1*new Date();
     for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
     k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
     (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

     ym(98476998, "init", {
          clickmap:true,
          trackLinks:true,
          accurateTrackBounce:true,
          webvisor:true
     });
  </script>
  <noscript><div><img src="https://mc.yandex.ru/watch/98476998" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
  <!-- /Yandex.Metrika counter -->
  <style>
    html, body {
      height: 100%; width: 100%;
      margin: 0; padding: 0;
    }
    .plyr__video-embed {
      width: 100vw;
      height: 100vh;
    }
  </style>
</head>
<body>

<div id="PLAYER" data-plyr-provider="youtube" data-plyr-embed-id="rKyBID8kPWY"></div><!-- dQw4w9WgXcQ -->

<script src="https://cdn.plyr.io/3.7.8/plyr.js"></script><script>
const videos = [ // –ú–∞—Å—Å–∏–≤ —Å –≤–∏–¥–µ–æ-—Å—Å—ã–ª–∫–∞–º–∏ (YouTube –∏ Vimeo)
  // YouTube
  { type: 'yt', id: 'tL6ZTcrDPAU' }, // Duke Ellington. Caravan
  { type: 'yt', id: '-tgKpW06mWU' }, // –ü–æ—Å–ª–µ–¥–Ω–∏–π –ï–¥–∏–Ω–æ—Ä–æ–≥ - –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è, –§—ç–Ω—Ç–µ–∑–∏, 1982 - –°–º–æ—Ç—Ä–µ—Ç—å –º—É–ª—å—Ç—Ñ–∏–ª—å–º—ã
  { type: 'yt', id: 'PrAczNE7OIo' }, // –ó–∞–≥–∞–¥–æ—á–Ω–∞—è –ø–ª–∞–Ω–µ—Ç–∞. –ú—É–ª—å—Ç—Ñ–∏–ª—å–º (1974)
  { type: 'yt', id: 'Bhsi7YgXlCA' }, // –ù–µ–∑–Ω–∞–π–∫–∞ - –≤—Å–µ —Å–µ—Ä–∏–∏
  { type: 'yt', id: 'volnH_bKpqk' }, // –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è –ë—É—Ä–∞—Ç–∏–Ω–æ. –°–±–æ—Ä–Ω–∏–∫ –ø–µ—Å–µ–Ω –∏–∑ —Ñ–∏–ª—å–º–∞ (1975)
  { type: 'yt', id: 'Jnl6Jf4yiu8' }, // –ü–µ—Å–Ω—è "–ö—Ä—ã–ª–∞—Ç—ã–µ –∫–∞—á–µ–ª–∏" –∏–∑ —Ñ–∏–ª—å–º–∞ "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞" (1979)
  { type: 'yt', id: 'DRYzImN_bDM' }, // –ü—Ä–µ–∫—Ä–∞—Å–Ω–æ–µ –¥–∞–ª–µ–∫–æ - –ø–µ—Å–Ω—è –∏–∑ –∫/—Ñ –ì–æ—Å—Ç—å—è –∏–∑ –±—É–¥—É—â–µ–≥–æ (1985)
  { type: 'yt', id: 'tay19RVx2fw' }, // –¢—Ä—è–º! –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –î–æ–±—Ä—ã–π —Å–æ–≤–µ—Ç—Å–∫–∏–π –º—É–ª—å—Ç—Ñ–∏–ª—å–º –ø—Ä–æ —ë–∂–∏–∫–∞ –∏ –º–µ–¥–≤–µ–∂–æ–Ω–∫–∞ (1980)
  { type: 'yt', id: 'sStuI47cE_4' }, // –ú–æ–π–¥–æ–¥—ã—Ä üí™ –î–µ—Ç—Å–∫–∞—è —Å–∫–∞–∑–∫–∞ –≤ —Å—Ç–∏—Ö–∞—Ö üíé –ó–æ–ª–æ—Ç–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –°–æ—é–∑–º—É–ª—å—Ç—Ñ–∏–ª—å–º HD
  { type: 'yt', id: 'LbOve_UZZ54' }, // –ü–æ –ø–æ–ª—è–º –°–∏–Ω–∏–π —Ç—Ä–∞–∫—Ç–æ—Ä –µ–¥–µ—Ç –∫ –Ω–∞–º - –ü–µ—Å–µ–Ω–∫–∞ –º—É–ª—å—Ç–∏–∫ –¥–ª—è –¥–µ—Ç–µ–π
  { type: 'yt', id: 'B9QtYhVBrZ4' }, // –°–∫–∞–∑–∫–∞ –¶–≤–µ—Ç–∏–∫-—Å–µ–º–∏—Ü–≤–µ—Ç–∏–∫ - –ó–æ–ª–æ—Ç–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –°–æ—é–∑–º—É–ª—å—Ç—Ñ–∏–ª—å–º
  { type: 'yt', id: 'oDbLk7xMS2Y' }, // koshkin dom 1958
  { type: 'yt', id: 'la7hwRw6SbY' }, // –ú–∞–º–∞ –¥–ª—è –º–∞–º–æ–Ω—Ç–µ–Ω–∫–∞. –ú—É–ª—å—Ç—Ñ–∏–ª—å–º (1981)
  { type: 'yt', id: 'BTWjS1qm9bM' }, // –ü–µ—Å–Ω—è "–ê –º–æ–∂–µ—Ç" –∏–∑ –º—É–ª—å—Ç—Ñ–∏–ª—å–º–∞ "–ü–ª–∞—Å—Ç–∏–ª–∏–Ω–æ–≤–∞—è –≤–æ—Ä–æ–Ω–∞" (1981)
  { type: 'yt', id: '71B2if-6EgE' }, // –ö–æ—Ä–æ–±–∫–∞ —Å –∫–∞—Ä–∞–Ω–¥–∞—à–∞–º–∏. –ú—É–ª—å—Ç—Ñ–∏–ª—å–º (1985)
  { type: 'yt', id: 'Uf1HoaM6ujo' }, // –£–º–Ω–∞—è —Å–æ–±–∞—á–∫–∞ –°–æ–Ω—è. –ú—É–ª—å—Ç—Ñ–∏–ª—å–º (1991)
  { type: 'yt', id: '-LuLoresKPg' }, // –ö—Ä–æ—à–∫–∞ –ï–Ω–æ—Ç. –ú—É–ª—å—Ç—Ñ–∏–ª—å–º (1974)
  { type: 'yt', id: 'EbP2zDza12g' }, // –ö–æ—Ç –∏ –õ–∏—Å–∞ - –°–∫–∞–∑–∫–∞ –¥–ª—è –¥–µ—Ç–µ–π - –ú—É–ª—å—Ç–∏–∫–∏ HD
  { type: 'yt', id: 'gMk_M96bGDM' }, // –ö—Ä–æ—à–µ—á–∫–∞-–•–∞–≤—Ä–æ—à–µ—á–∫–∞ | –†—É—Å—Å–∫–∞—è —Å–∫–∞–∑–∫–∞ | –º—É–ª—å—Ç–∫ –¥–ª—è –¥–µ—Ç–µ–π | Kroshechka Khavroshechka | Kids Tv Russia
  { type: 'yt', id: 'GCXLxkU0x2I' }, // –ö–æ–ª–æ–±–æ–∫ | —Ä–∞–∑–≤–∏–≤–∞—é—â–∏–µ –≤–∏–¥–µ–æ | —Ä—É—Å—Å–∫–∏–π –º—É–ª—å—Ç—Ñ–∏–ª—å–º | –¥–µ—Ç–∏ –≤–∏–¥–µ–æ | Kolobok | Russian Kids Stories
  { type: 'yt', id: 'q4x5u0Xn0oA' }, // –°–∏–Ω–∏–π —Ç—Ä–∞–∫—Ç–æ—Ä –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç | –ù–∞—Å–µ–∫–æ–º—ã–µ | –ü–µ—Å–µ–Ω–∫–∏ –º—É–ª—å—Ç–∏–∫–∏ –¥–ª—è –¥–µ—Ç–µ–π
  { type: 'yt', id: '1m8IyfG925Q' }, // Baby Shark Dance | Baile del Tibur√≥n Beb√© | Pinkfong Canciones Infantiles
  { type: 'yt', id: 'rfrvlF2t6t4' }, // –ú—É–ª—å—Ç—Ñ–∏–ª—å–º –°–°–°–† "–ü–µ—Ç—è –∏ –ö—Ä–∞—Å–Ω–∞—è —à–∞–ø–æ—á–∫–∞" 1958 –≥–æ–¥.
  { type: 'yt', id: 'ix66VKwPPu4' }, // –ö–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –≥—É–ª—è–ª —Å–∞–º –ø–æ —Å–µ–±–µ (1968 –≥–æ–¥) –º—É–ª—å—Ç—Ñ–∏–ª—å–º
  { type: 'yt', id: 'bCtlituS9p8' }, // Tom & Jerry | Trouble Everywhere | Classic Cartoon Compilation | WB Kids
  { type: 'yt', id: 'ifERvQbIv8o' }, // Bugs Bunny Builders | Coyote Is Done with the Beep Beep | ‚Ä™@wbkids‚Ä¨ 
  { type: 'yt', id: 'JmG0pHyZP3E' }, // Bugs Bunny Builders | Rock On! | ‚Ä™@wbkids‚Ä¨ 
  { type: 'yt', id: 'vQHW4vORqRw' }, // –ö–æ—Ç –õ–µ–æ–ø–æ–ª—å–¥. –°–µ—Ä–∏—è 10. –ü–æ–ª–∏–∫–ª–∏–Ω–∏–∫–∞ –∫–æ—Ç–∞ –õ–µ–æ–ø–æ–ª—å–¥–∞ (1986)
  { type: 'yt', id: 'CErf41K1tTI' }, // –ú–µ—Å—Ç—å –∫–æ—Ç–∞ –õ–µ–æ–ø–æ–ª—å–¥–∞. –°–µ—Ä–∏—è 1. –ú—É–ª—å—Ç—Ñ–∏–ª—å–º (1975)
  { type: 'yt', id: 'mPKsyTqwjlg' }, // –¢–∞–±–ª–∏—Ü–∞ –£–ú–ù–û–ñ–ï–ù–ò–Ø –≤ —Å—Ç–∏—Ö–∞—Ö - –∑–∞–ø–æ–º–Ω–∏—Ç–µ –Ω–∞ —Ä–∞–∑ - –¥–≤–∞!
  { type: 'yt', id: 'AfXS1EUxzZE' }, // –ú–∞—à–∞ –∏ –õ–µ–æ–ø–æ–ª—å–¥. –ü—ã–ª–µ—Å–æ—Å —ç–º–æ—Ü–∏–π - –°–µ—Ä–∏–∏ –¥–ª—è –≤—Å–µ–π —Å–µ–º—å–∏ - Lion Family –Ω–∞ —Ä—É—Å—Å–∫–æ–º -–ú—É–ª—å—Ç–∏–∫
  { type: 'yt', id: '5a6pDc-U294' }, // –ê–∑–±—É–∫–∞_–ò–Ω—Ç–µ—Ä–Ω–µ—Ç–∞. –í–°–ï —Å–µ—Ä–∏–∏ - –°–º–µ—à–∞—Ä–∏–∫–∏ 2D
  { type: 'yt', id: 'puEbWbLq8IA' }, // –£—á–∏–º –ø–µ—Ä–≤—ã–µ —Å–ª–æ–≤–∞ –ó–∞–ø—É—Å–∫ —Ä–µ—á–∏ –ù–æ–≤—ã–π –≤—ã–ø—É—Å–∫
  { type: 'yt', id: 'YETVZJMFK6c' }, // –û—Ö –∏ –ê—Ö ‚óè –í—Å–µ —Å–µ—Ä–∏–∏ –ø–æ–¥—Ä—è–¥ ‚óè –°–±–æ—Ä–Ω–∏–∫ –º—É–ª—å—Ç—Ñ–∏–ª—å–º–æ–≤
  { type: 'yt', id: '9hDjp0C79-c' }, // –ü–∞–¥–∞–ª –ø—Ä–æ—à–ª–æ–≥–æ–¥–Ω–∏–π —Å–Ω–µ–≥. –°–æ–≤–µ—Ç—Å–∫–∏–π –ø–ª–∞—Å—Ç–∏–ª–∏–Ω–æ–≤—ã–π –º—É–ª—å—Ç—Ñ–∏–ª—å–º (1983)
  { type: 'yt', id: 'BihaXNoR9J0' }, // –°–ª–µ–¥—Å—Ç–≤–∏–µ –≤–µ–¥—É—Ç –ö–æ–ª–æ–±–∫–∏. –í—Å–µ —Å–µ—Ä–∏–∏ –º—É–ª—å—Ç—Ñ–∏–ª—å–º–∞ (1986)
  { type: 'yt', id: 'ak044vR5_yc' }, // –ó–∞–π—Ü–∞ –Ω–µ –≤–∏–¥–∞–ª–∏? –ú—É–ª—å—Ç—Ñ–∏–ª—å–º (1985)
  { type: 'yt', id: 'aTkfgOPDjq0' }, // –ú –ú–∞–≥–æ–º–∞–µ–≤ –õ—É—á –°–æ–ª–Ω—Ü–∞ –ó–æ–ª–æ—Ç–æ–≥–æ
  { type: 'yt', id: '9KxZDFIy2n4' }, // –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è –∫–∞–ø–∏—Ç–∞–Ω–∞ –í—Ä—É–Ω–≥–µ–ª—è. –ü–µ—Å–Ω—è "–ú—ã –±–∞–Ω–¥–∏—Ç–æ" (1979)
  { type: 'yt', id: 'v5vdc-HfEEA' }, // –ö–æ–Ω—Ç–∞–∫—Ç –º—É–ª—å—Ç—Ñ–∏–ª—å–º –°–°–°–† 1978
  { type: 'yt', id: 'LQiuImJmceI' }, // —á–∏–ø –∏ –î–µ–π–ª —Å–ø–µ—à–∞—Ç –Ω–∞ –ø–æ–º–æ—â—å 3 —Å–µ—Ä–∏—è
  { type: 'yt', id: 'uZOxM7YB3AU' }, // –ì—É–±–∫–∞ –ë–æ–± –ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ –®—Ç–∞–Ω—ã | –ö—Ä–∞–±–±–∏–ª–µ–Ω–¥ | –ü–æ–ª–Ω—ã–π —ç–ø–∏–∑–æ–¥ | Nickelodeon –†–æ—Å—Å–∏—è
  { type: 'yt', id: 'vSufNvOtw8Q' }, // –í–∏–Ω–Ω–∏ –ü—É—Ö (–Ω–∞ —Ä—É—Å—Å–∫–æ–º) –ú–µ–¥–æ–≤—ã–π –ø–∏—Ä
  { type: 'yt', id: 'MRq4qZM8kRg' }, // –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è –∫–∞–ø–∏—Ç–∞–Ω–∞ –í—Ä—É–Ω–≥–µ–ª—è. –ú—É–ª—å—Ç—Ñ–∏–ª—å–º. –í—Å–µ —Å–µ—Ä–∏–∏ (1976-79)
  { type: 'yt', id: '-VfZ6Tdx0fY' }, // –¢–∞–π–Ω–∞ —Ç—Ä–µ—Ç—å–µ–π –ø–ª–∞–Ω–µ—Ç—ã. –ê–ª–∏—Å–∞ –°–µ–ª–µ–∑–Ω—ë–≤–∞. –ê–ª–∏—Å–∞. –ó–µ–ª—ë–Ω—ã–π. –ü—Ä–æ—Ñ–µ—Å—Å–æ—Ä. –®—Ç—É—Ä–º–∞–Ω. –ë–∞—Å–æ–≤.
  { type: 'yt', id: 'vWtOqPGWtkw' }, // –§–∞–Ω—Ç–∞—Å—Ç–∏—á–µ—Å–∫–∏–π –º—É–ª—å—Ç—Ñ–∏–ª—å–º - –î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è –ê–ª–∏—Å—ã
  { type: 'yt', id: 'EbO_4oVE3pg' }, // –ê–ª–∏—Å–∞ –≤ —Å—Ç—Ä–∞–Ω–µ —á—É–¥–µ—Å. –í—Å–µ —Å–µ—Ä–∏–∏. –ú—É–ª—å—Ç—Ñ–∏–ª—å–º –ø–æ –º–æ—Ç–∏–≤–∞–º —Å–∫–∞–∑–∫–∏ –õ—å—é–∏—Å–∞ –ö—ç—Ä—Ä–æ–ª–ª–∞ (1981)
  { type: 'yt', id: 'hMe2uS6m7EM' }, // –¢–∞–π–Ω–∞ —Ç—Ä–µ—Ç—å–µ–π –ø–ª–∞–Ω–µ—Ç—ã (–Ω–µ–π—Ä–æ—Å–µ—Ç—å Midjourney)
  { type: 'yt', id: 'xMQhq5LR1fk' }, // –ñ–∏–ª –ë—ã–ª –ü–µ—Å: –ò—Å—Ç–æ—Ä–∏—è –°–æ–∑–¥–∞–Ω–∏—è –®–ï–î–ï–í–†–ê –°–æ–≤–µ—Ç—Å–∫–æ–π –ê–Ω–∏–º–∞—Ü–∏–∏
  // { type: 'yt', id: '' },
  // { type: 'yt', id: '' },
  // { type: 'yt', id: '' },
  // { type: 'yt', id: '' },
  // { type: 'yt', id: '' },
  // { type: 'yt', id: '' },
  // { type: 'yt', id: '' },
  // { type: 'yt', id: '' },
  // { type: 'yt', id: '' },
  // { type: 'yt', id: '' },
  // { type: 'yt', id: '' },
  
  // Vimeo –¥–ª—è —á–µ—Ä–µ–¥–æ–≤–∞–Ω–∏—è —Å YouTube (–ø–æ–º–æ–≥–∞–µ—Ç —Å –æ—á–∏—Å—Ç–∫–æ–π –ø–∞–º—è—Ç–∏)
  { type: 'vi', id: '162736398' }, // Nature documentary
  { type: 'vi', id: '56282283' },  // Short film
  { type: 'vi', id: '148751763' }, // Animation
  { type: 'vi', id: '125095515' } // Art/Creative
];
let currentIndex = 0; // –¢–µ–∫—É—â–∏–π –∏–Ω–¥–µ–∫—Å –≤–∏–¥–µ–æ
const container = document.getElementById('PLAYER');
let player = null;
let videoChangeCount = 0;
const MAX_VIDEOS_BEFORE_RECREATE = 5; // –ü–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º –ø–ª–µ–µ—Ä –∫–∞–∂–¥—ã–µ 5 –≤–∏–¥–µ–æ
let memoryCheckInterval;
let lastProvider = null; // –ü–æ—Å–ª–µ–¥–Ω–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä
const PREFER_PROVIDER_ALTERNATION = false; // –û—Ç–∫–ª—é—á–µ–Ω–æ - –Ω–µ –º–µ—à–∞–µ–º –º–æ–Ω–æ–∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
let consecutiveFailures = 0;
const MAX_CONSECUTIVE_FAILURES = 3;
let currentVideoTimeout = null;
const VIDEO_LOAD_TIMEOUT = 15000; // 15 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É
let isRecovering = false;
let watchdogInterval = null;
let lastCurrentTime = -1;
let stuckTimeCount = 0;
let zeroTimeCount = 0; // –°—á–µ—Ç—á–∏–∫ –¥–ª—è currentTime = 0
let WATCHDOG_CHECK_INTERVAL = 3000; // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã (–º–æ–∂–µ—Ç —É–º–µ–Ω—å—à–∞—Ç—å—Å—è)
const WATCHDOG_FAST_INTERVAL = 1000; // –£—Å–∫–æ—Ä–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö
const MAX_STUCK_CHECKS = 3; // 3 –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥—Ä—è–¥ = 9 —Å–µ–∫—É–Ω–¥ –±–µ–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
const MAX_ZERO_TIME_CHECKS = 4; // 4 –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥—Ä—è–¥ = 12 —Å–µ–∫—É–Ω–¥ –Ω–∞ currentTime=0

// –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–∞–º—è—Ç–∏
function logMemoryUsage() {
  if (performance.memory) {
    const memory = performance.memory;
    const used = Math.round(memory.usedJSHeapSize / 1024 / 1024);
    const total = Math.round(memory.totalJSHeapSize / 1024 / 1024);
    const limit = Math.round(memory.jsHeapSizeLimit / 1024 / 1024);
    console.log(`Memory: ${used}MB / ${total}MB (limit: ${limit}MB) - Video: ${videoChangeCount}`);
    
    // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞
    if (used > limit * 0.8) {
      console.warn('Memory usage high, forcing player recreation');
      videoChangeCount = MAX_VIDEOS_BEFORE_RECREATE - 1; // –ó–∞—Å—Ç–∞–≤–ª—è–µ–º –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º –≤–∏–¥–µ–æ
    }
  }
}

// –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞ –º—É—Å–æ—Ä–∞
function forceGarbageCollection() {
  if (window.gc) {
    window.gc();
    console.log('Manual garbage collection triggered');
  }
}

// Watchdog –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Ç–∏—Ö–∏—Ö –∑–∞–≤–∏—Å–∞–Ω–∏–π
function startWatchdog() {
  stopWatchdog();
  lastCurrentTime = -1;
  stuckTimeCount = 0;
  
  // –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–æ–∫
  const interval = consecutiveFailures > 0 ? WATCHDOG_FAST_INTERVAL : WATCHDOG_CHECK_INTERVAL;
  console.log(`Starting watchdog with ${interval}ms interval (failures: ${consecutiveFailures})`);
  
  watchdogInterval = setInterval(() => {
    if (!player || isRecovering) return;
    
    try {
      const currentTime = player.currentTime || 0;
      const duration = player.duration || 0;
      const isPaused = player.paused;
      const hasEnded = player.ended;
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –≤–∏–¥–µ–æ —ç–ª–µ–º–µ–Ω—Ç–∞
      const videoElement = player.media;
      const hasVideoElement = videoElement && videoElement.tagName;
      const videoVisible = hasVideoElement && videoElement.videoWidth > 0 && videoElement.videoHeight > 0;
      
      // –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
      console.log(`Watchdog: time=${Math.round(currentTime)}s, duration=${Math.round(duration)}s, paused=${isPaused}, ended=${hasEnded}, stuck=${stuckTimeCount}, video=${videoVisible}`);
      
      // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –µ—Å–ª–∏ –≤–∏–¥–µ–æ –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å
      if (hasEnded) {
        console.log('Video ended normally, stopping watchdog');
        return;
      }
      
      // –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–æ–ø–∞–≤—à–µ–≥–æ –≤–∏–¥–µ–æ (—Ç–æ–ª—å–∫–æ –∑–≤—É–∫)
      if (hasVideoElement && !videoVisible && currentTime > 0 && !isPaused) {
        console.warn('Video disappeared but audio continues - likely postMessage issue');
        handleVideoFailure('watchdog_video_disappeared');
        return;
      }
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
      if (!isPaused && duration > 0) {
        // –û—Å–æ–±–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è currentTime = 0 (—á–∞—Å—Ç–æ –ø—Ä–∏–∑–Ω–∞–∫ –∑–∞–≤–∏—Å–∞–Ω–∏—è)
        if (currentTime === 0) {
          zeroTimeCount++;
          console.warn(`Video stuck at 0s - not starting (check ${zeroTimeCount}/${MAX_ZERO_TIME_CHECKS})`);
          
          if (zeroTimeCount >= MAX_ZERO_TIME_CHECKS) {
            console.error('Video never started! Triggering recovery...');
            handleVideoFailure('watchdog_never_started');
            return;
          }
        } else {
          // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –Ω—É–ª–µ–≤–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
          if (zeroTimeCount > 0) {
            console.log('Video started playing, resetting zero-time counter');
            zeroTimeCount = 0;
          }
          
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±—ã—á–Ω–æ–µ –∑–∞—Å—Ç—Ä—è–≤–∞–Ω–∏–µ
          if (lastCurrentTime >= 0 && lastCurrentTime === currentTime) {
            stuckTimeCount++;
            console.warn(`Video seems stuck at ${Math.round(currentTime)}s (check ${stuckTimeCount}/${MAX_STUCK_CHECKS})`);
            
            if (stuckTimeCount >= MAX_STUCK_CHECKS) {
              console.error('Video stuck detected! Triggering recovery...');
              handleVideoFailure('watchdog_stuck');
              return;
            }
          } else {
            if (stuckTimeCount > 0) {
              console.log('Video progress resumed, resetting stuck counter');
              stuckTimeCount = 0;
            }
          }
        }
        lastCurrentTime = currentTime;
      }
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω—É—é –ø–∞—É–∑—É (–º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–≤–∏—Å–ª–æ)
      if (isPaused && duration > 0 && currentTime > 0) {
        stuckTimeCount++;
        if (stuckTimeCount >= MAX_STUCK_CHECKS * 2) { // –î–∞–µ–º –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –ø–∞—É–∑—ã
          console.warn('Video paused too long, might be stuck');
          handleVideoFailure('watchdog_paused_stuck');
        }
      }
      
    } catch (error) {
      console.error('Watchdog error:', error);
      handleVideoFailure('watchdog_error');
    }
  }, interval);
  
  console.log(`Watchdog started with ${interval}ms interval`);
}

function stopWatchdog() {
  if (watchdogInterval) {
    clearInterval(watchdogInterval);
    watchdogInterval = null;
    console.log('Watchdog stopped');
  }
  lastCurrentTime = -1;
  stuckTimeCount = 0;
  zeroTimeCount = 0;
}

function getRandomInt(max) {
  return Math.floor(Math.random() * max);
}

function createPlayer() {
  return new Plyr(container, { 
    autoplay: true, 
    controls: ['play', 'progress', 'mute', 'volume', 'fullscreen']
  });
}

function destroyPlayer(forceful = false) {
  stopWatchdog();
  clearVideoTimeout();
  
  if (player) {
    try {
      player.off('ended');
      player.off('ready');
      player.off('play');
      player.off('pause');
      player.off('playing');
      player.off('error');
      player.off('loadstart');
      player.off('canplay');
      player.off('stalled');
      player.off('waiting');
      player.destroy();
    } catch (e) {
      console.warn('Error destroying player:', e);
    }
    player = null;
  }
  
  // –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ iframe —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–º —Å–±—Ä–æ—Å–µ
  if (forceful) {
    console.log('Forceful cleanup - removing all iframes');
    const iframes = document.querySelectorAll('iframe');
    iframes.forEach((iframe, index) => {
      try {
        // –ú—è–≥–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
        setTimeout(() => {
          if (iframe.contentWindow && iframe.contentWindow.YT) {
            iframe.contentWindow.YT = null;
          }
          iframe.src = 'about:blank';
          setTimeout(() => {
            iframe.parentNode && iframe.parentNode.removeChild(iframe);
          }, 100);
        }, index * 50); // –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —É–¥–∞–ª—è–µ–º
      } catch (e) {
        console.warn('Error cleaning iframe:', e);
      }
    });
    
    setTimeout(() => {
      container.innerHTML = '';
      container.className = '';
      forceGarbageCollection();
      container.innerHTML = '<div data-plyr-provider="youtube" data-plyr-embed-id=""></div>';
    }, 500);
  } else {
    // –ú—è–≥–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ - –ø—Ä–æ—Å—Ç–æ –æ—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
    console.log('Gentle cleanup - preserving iframes');
    setTimeout(() => {
      container.innerHTML = '<div data-plyr-provider="youtube" data-plyr-embed-id=""></div>';
    }, 100);
  }
}

function loadVideo(index) { // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–∏–¥–µ–æ
  const video = videos[index];
  videoChangeCount++;
  
  // –ü–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º –ø–ª–µ–µ—Ä –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ø–∞–º—è—Ç–∏
  if (!player || videoChangeCount % MAX_VIDEOS_BEFORE_RECREATE === 0) {
    console.log('Recreating player for memory cleanup...'); 
    const needsForcefulCleanup = consecutiveFailures > 1 || videoChangeCount % (MAX_VIDEOS_BEFORE_RECREATE * 2) === 0;
    destroyPlayer(needsForcefulCleanup);
    
    const delay = needsForcefulCleanup ? 600 : 200; // –ë–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –æ—á–∏—Å—Ç–∫–µ
    setTimeout(() => {
      player = createPlayer();
      setupPlayerEvents();
      setVideoSource(video);
    }, delay);
    return;
  }
  
  setVideoSource(video);
}

function setVideoSource(video) {
  lastProvider = video.type;
  stopWatchdog(); // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π watchdog
  
  const videoTitle = videos.find(v => v.id === video.id)?.title || video.id;
  console.log(`Loading ${video.type === 'yt' ? 'YouTube' : 'Vimeo'} video: ${videoTitle} (${video.id}) - failures: ${consecutiveFailures}, stuck: ${stuckTimeCount}`);
  
  try {
    if (video.type === 'yt') {
      player.source = {
        type: 'video',
        sources: [{
          src: video.id,
          provider: 'youtube',
        }],
      };
    } else if (video.type === 'vi') {
      player.source = {
        type: 'video',
        sources: [{
          src: video.id,
          provider: 'vimeo',
        }],
      };
    }
    
    startVideoTimeout();
    
    setTimeout(() => {
      if (!isRecovering) {
        player.play().catch(e => {
          console.warn('Autoplay blocked or failed:', e);
        });
      }
    }, 200); // –ù–µ–º–Ω–æ–≥–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∑–∞–¥–µ—Ä–∂–∫—É
    
  } catch (error) {
    console.error('Error setting video source:', error);
    handleVideoFailure('source_error');
  }
}

function getNextVideoIndex() {
  // –ü—Ä–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö –ø–æ–¥—Ä—è–¥, –ø—Ä–æ–±—É–µ–º –¥—Ä—É–≥–æ–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä
  if (consecutiveFailures >= 2 && lastProvider) {
    const alternativeProviders = videos.filter(v => v.type !== lastProvider);
    if (alternativeProviders.length > 0) {
      console.log('Multiple failures, trying different provider');
      const randomAlt = alternativeProviders[getRandomInt(alternativeProviders.length)];
      return videos.indexOf(randomAlt);
    }
  }
  
  // –û–±—ã—á–Ω—ã–π —Å–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä
  let newIndex;
  do {
    newIndex = getRandomInt(videos.length);
  } while (newIndex === currentIndex && videos.length > 1); // –ù–µ –ø–æ–≤—Ç–æ—Ä—è–µ–º —Ç–æ –∂–µ –≤–∏–¥–µ–æ
  
  return newIndex;
}

function clearVideoTimeout() {
  if (currentVideoTimeout) {
    clearTimeout(currentVideoTimeout);
    currentVideoTimeout = null;
  }
}

function startVideoTimeout() {
  clearVideoTimeout();
  currentVideoTimeout = setTimeout(() => {
    console.warn('Video load timeout, trying next video');
    handleVideoFailure('timeout');
  }, VIDEO_LOAD_TIMEOUT);
}

function handleVideoFailure(reason) {
  if (isRecovering) return;
  
  consecutiveFailures++;
  console.error(`Video failure (${reason}). Consecutive failures: ${consecutiveFailures}`);
  
  clearVideoTimeout();
  stopWatchdog();
  isRecovering = true;
  
  const isWatchdogFailure = reason.includes('watchdog');
  const forceRecreation = consecutiveFailures >= MAX_CONSECUTIVE_FAILURES || isWatchdogFailure;
  
  if (forceRecreation) {
    console.warn(`${isWatchdogFailure ? 'Watchdog failure' : 'Too many consecutive failures'}, forcing player recreation`);
    videoChangeCount = MAX_VIDEOS_BEFORE_RECREATE - 1;
    consecutiveFailures = 0;
  }
  
  const delay = isWatchdogFailure ? 500 : 2000;
  setTimeout(() => {
    currentIndex = getNextVideoIndex();
    loadVideo(currentIndex);
    isRecovering = false;
  }, delay);
}

function handleVideoSuccess() {
  consecutiveFailures = 0;
  clearVideoTimeout();
  isRecovering = false;
  stuckTimeCount = 0;
  zeroTimeCount = 0;
}

function setupPlayerEvents() {
  // –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ —Å–æ–±—ã—Ç–∏–π
  function safeEventHandler(eventName, handler) {
    return function(...args) {
      try {
        handler.apply(this, args);
      } catch (e) {
        if (e.message && e.message.includes('postMessage')) {
          console.warn(`PostMessage error in ${eventName} event, ignoring:`, e.message);
        } else {
          console.error(`Error in ${eventName} event:`, e);
          // –ü—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö –∑–∞–ø—É—Å–∫–∞–µ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
          handleVideoFailure(`event_${eventName}_error`);
        }
      }
    };
  }

  player.on('ended', safeEventHandler('ended', function () {
    console.log('Video ended normally');
    stopWatchdog();
    handleVideoSuccess();
    currentIndex = getNextVideoIndex();
    loadVideo(currentIndex);
  }));

  player.on('ready', safeEventHandler('ready', function () {
    console.log('Player ready, starting playback');
    handleVideoSuccess();
    if (player && player.play) {
      player.play().catch(e => {
        console.warn('Autoplay failed:', e);
      });
    }
  }));
  
  player.on('error', safeEventHandler('error', function (e) {
    console.error('Player error:', e);
    stopWatchdog();
    handleVideoFailure('player_error');
  }));
  
  player.on('loadstart', safeEventHandler('loadstart', function () {
    console.log('Video loading started');
    stopWatchdog();
    startVideoTimeout();
  }));
  
  player.on('canplay', safeEventHandler('canplay', function () {
    console.log('Video can start playing');
    clearVideoTimeout();
  }));
  
  player.on('playing', safeEventHandler('playing', function () {
    console.log('Video is playing - starting watchdog');
    handleVideoSuccess();
    startWatchdog();
  }));
  
  player.on('pause', safeEventHandler('pause', function () {
    console.log('Video paused');
  }));
  
  player.on('stalled', safeEventHandler('stalled', function () {
    console.warn('Video stalled - watchdog will handle if needed');
  }));
  
  player.on('waiting', safeEventHandler('waiting', function () {
    console.warn('Video waiting for data');
  }));
}

// –ú–∞–Ω—É–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ (–ø—Ä–æ–±–µ–ª –∏–ª–∏ –∫–ª–∏–∫)
function forceNextVideo() {
  console.log('Manual skip triggered');
  clearVideoTimeout();
  stopWatchdog();
  consecutiveFailures = Math.max(0, consecutiveFailures - 1);
  isRecovering = false; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
  currentIndex = getNextVideoIndex();
  loadVideo(currentIndex);
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –∫–∞–∂–¥—ã–µ –º–∏–Ω—É—Ç—É
function healthCheck() {
  if (player && !isRecovering) {
    const currentTime = player.currentTime;
    const duration = player.duration;
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞—Å—Ç—Ä—è–ª–æ –ª–∏ –≤–∏–¥–µ–æ
    if (currentTime > 0 && currentTime === player._lastHealthCheckTime && !player.paused) {
      console.warn('Video seems stuck, forcing next video');
      handleVideoFailure('health_check_stuck');
      return;
    }
    
    player._lastHealthCheckTime = currentTime;
    
    // –õ–æ–≥–∏—Ä—É–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    if (currentTime > 0 && duration > 0) {
      const progress = Math.round((currentTime / duration) * 100);
      console.log(`Playback health: ${progress}% (${Math.round(currentTime)}s/${Math.round(duration)}s)`);
    }
  }
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
document.addEventListener('keydown', function(e) {
  if (e.code === 'Space' || e.key === 'n' || e.key === 'N') {
    e.preventDefault();
    forceNextVideo();
  }
});

// –ö–ª–∏–∫ –ø–æ —ç–∫—Ä–∞–Ω—É –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–∏–¥–µ–æ (–Ω–æ –Ω–µ –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª—ã –ø–ª–µ–µ—Ä–∞)
document.addEventListener('click', function(e) {
  if (!e.target.closest('.plyr__controls')) {
    forceNextVideo();
  }
});

// –ü–µ—Ä–µ—Ö–≤–∞—Ç postMessage –æ—à–∏–±–æ–∫
window.addEventListener('error', function(e) {
  if (e.message && e.message.includes('postMessage')) {
    console.warn('Caught postMessage error, ignoring:', e.message);
    return true; // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –≤—Å–ø–ª—ã–≤–∞–Ω–∏–µ
  }
});

// –ü–µ—Ä–µ—Ö–≤–∞—Ç unhandled promise rejections
window.addEventListener('unhandledrejection', function(e) {
  if (e.reason && e.reason.toString && e.reason.toString().includes('postMessage')) {
    console.warn('Caught postMessage promise rejection, ignoring:', e.reason);
    e.preventDefault();
  }
});

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
player = createPlayer();
setupPlayerEvents();
loadVideo(currentIndex); // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–≤–æ–≥–æ –≤–∏–¥–µ–æ

// –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–∞–º—è—Ç–∏ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
memoryCheckInterval = setInterval(logMemoryUsage, 30000);
logMemoryUsage(); // –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
setInterval(healthCheck, 60000);
</script></body></html>
